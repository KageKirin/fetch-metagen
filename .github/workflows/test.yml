# This workflow will run tests using node and then publish a package to GitHub Packages when a release is created
# For more information see: https://help.github.com/actions/language-and-framework-guides/publishing-nodejs-packages

name: Fetch Test

on: [push]

jobs:
  fetch:
    runs-on: ubuntu-latest
    steps:
      - name: Fetch release
        uses: dsaltares/fetch-gh-release-asset@master
        with:
          repo: "KageKirin/metagen-rs"
          #version: "tags/v0.1.18" latest
          file: "metagen.tar.gz"
          target: "metagen.tar.gz"
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: Unpack
        run: |
          ls *
          tar tvf metagen.tar.gz
          tar xvfp metagen.tar.gz --strip 3
          ls *
      - name: Test run
        run: ./metagen --help
